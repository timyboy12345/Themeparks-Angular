<app-button link="../" *ngIf="park" buttonText="Terug naar {{ park.name }}"></app-button>

<app-card *ngIf="restaurants && restaurants.length > 0" cardTitle="Filteren">
  <div class="flex flex-col mb-2" *ngIf="parkService && parkService.supportsRideAreas">
    <label for="restaurantArea" class="mb-1">Themagebied</label>
    <select class="appearance-none outline-none focus:ring-3 ring-indigo-700 ring-opacity-40 border-gray-300 border rounded bg-white text-gray-900" id="restaurantArea" [(ngModel)]="restaurantArea">
      <option value="">Alle themagebieden</option>
      <option *ngFor="let area of areas" [value]="area">{{ area }}</option>
    </select>
  </div>

  <div class="flex flex-col">
    <label for="displayType" class="mb-1">Weergave</label>
    <select (ngModelChange)="saveDisplayType($event)" class="appearance-none outline-none focus:ring-3 ring-indigo-700 ring-opacity-40 border-gray-300 border rounded bg-white text-gray-900" id="displayType" [(ngModel)]="displayType">
      <option value="cards">Kaarten</option>
      <option value="list">Lijst</option>
    </select>
  </div>
</app-card>

<div *ngIf="restaurants && restaurants.length > 0; else restaurantsLoading">
  <div *ngIf="displayType === 'cards'" class="flex flex-col md:flex-row flex-wrap -mx-4">
    <div *ngFor="let restaurant of selectedRestaurants" class="md:w-1/2 lg:w-1/3">
      <div [routerLink]="restaurant.id"
           class="cursor-pointer m-4 h-72 relative flex flex-col rounded shadow hover:shadow-2xl transition-all duration-100 overflow-hidden">
        <div *ngIf="restaurant.image_url" class="h-72 overflow-hidden">
          <img class="bg-gray-300 w-full h-full object-center object-cover" [lazyLoad]="restaurant.image_url">
        </div>

        <div *ngIf="restaurant.openingTimes" class="absolute bg-white shadow left-4 top-4 rounded py-1 px-2 text-sm text-gray-900">
          <span class="flex flex-row" *ngIf="restaurant.openingTimes.length > 0">
            {{ restaurant.openingTimes[0].openTime }} - {{ restaurant.openingTimes[0].closeTime }}
          </span>

          <span class="text-gray-600 dark:text-gray-500" *ngIf="restaurant.openingTimes.length == 0">
            Geen openingstijden <span class="lg:hidden">bekend</span>
          </span>
        </div>

        <div *ngIf="restaurant.area" class="absolute shadow right-4 top-4 rounded py-1 px-2 text-sm text-white bg-indigo-700">
          {{ restaurant.area }}
        </div>

        <div class="absolute w-full bottom-0">
          <div class="p-4 bg-white rounded m-4 shadow m-4">
            <h2 class="text-indigo-800 font-bold">{{ restaurant.title }}</h2>

            <div *ngIf="restaurant.minSizeEscort">Minimaal met begeleiding: {{ restaurant.minSizeEscort }} cm</div>
            <div *ngIf="restaurant.minSize">Zonder begeleiding: {{ restaurant.minSize }} cm</div>
            <div *ngIf="restaurant.maxSize">Maximaal: {{ restaurant.minSize }} cm</div>

            <div>{{ restaurant.area }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <app-card *ngIf="displayType === 'list'" padding="p-0" cardClasses="flex flex-col my-4">
    <div *ngFor="let restaurant of selectedRestaurants; let last = last;" [routerLink]="restaurant.id" [ngClass]="{'border-b': !last}"
         class="border-gray-100 dark:border-gray-700 p-3 flex flex-row items-center cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-900 transition duration-100">

      <div class="w-8 h-8 relative bg-indigo-700 rounded-full overflow-hidden mr-2">
        <img alt="Image of {{ restaurant.title }}" *ngIf="restaurant.image_url"
             class="w-full h-full absolute left-0 top-0 object-center object-cover" [src]="restaurant.image_url">
      </div>

      <div class="flex-grow flex flex-col md:flex-row justify-between">
        <div class="text-indigo-800 dark:text-indigo-200 font-bold">{{ restaurant.title }}</div>

        <div *ngIf="restaurant.openingTimes" class="text-gray-500 dark:text-gray-400">
          <span class="flex flex-row" *ngIf="restaurant.openingTimes.length > 0">
            {{ restaurant.openingTimes[0].openTime }} - {{ restaurant.openingTimes[0].closeTime }}
          </span>

          <span class="text-gray-600 dark:text-gray-500" *ngIf="restaurant.openingTimes.length == 0">
            Geen openingstijden bekend
          </span>
        </div>
      </div>
    </div>
  </app-card>
</div>

<ng-template #restaurantsLoading>
  <app-card *ngIf="restaurants == null" cardClasses="mt-8">
    <div class="text-lg text-indigo-800">Restaurants ophalen</div>
    <p class="text-gray-600">De restaurants worden geladen...</p>
  </app-card>

  <app-card *ngIf="restaurants && restaurants.length == 0" cardClasses="mt-8">
    <div class="text-lg text-indigo-800">Geen restaurants gevonden</div>
    <p class="text-gray-600">We konden geen restaurants ophalen</p>
  </app-card>
</ng-template>
